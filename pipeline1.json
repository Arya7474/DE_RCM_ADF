{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"factoryName":{"type":"string","metadata":"Data Factory name"},"githubEMRFiles":{"type":"string"},"hosaSqlDB":{"type":"string"}},"variables":{"factoryId":"[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"},"resources":[{"name":"[concat(parameters('factoryName'), '/pipeline1')]","type":"Microsoft.DataFactory/factories/pipelines","apiVersion":"2018-06-01","properties":{"activities":[{"name":"ForEach1","type":"ForEach","dependsOn":[],"userProperties":[],"typeProperties":{"items":{"value":"@pipeline().parameters.P_array","type":"Expression"},"isSequential":false,"activities":[{"name":"Copy data1","type":"Copy","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":0,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"userProperties":[],"typeProperties":{"source":{"type":"DelimitedTextSource","storeSettings":{"type":"HttpReadSettings","requestMethod":"GET"},"formatSettings":{"type":"DelimitedTextReadSettings"}},"sink":{"type":"AzureSqlSink","writeBehavior":"insert","sqlWriterUseTableLock":false},"enableStaging":false,"translator":{"type":"TabularTranslator","typeConversion":true,"typeConversionSettings":{"allowDataTruncation":true,"treatBooleanAsNumber":false}}},"inputs":[{"referenceName":"gitEMRds","type":"DatasetReference","parameters":{"filename":{"value":"@item().filename","type":"Expression"}}}],"outputs":[{"referenceName":"hosaDS","type":"DatasetReference","parameters":{"tablename":{"value":"@split(item().filename,'0')","type":"Expression"}}}]}]}}],"policy":{"elapsedTimeMetric":{}},"parameters":{"P_array":{"type":"array","defaultValue":[{"filename":"departments.csv"},{"filename":"encounters.csv"},{"filename":"patients.csv"},{"filename":"providers.csv"},{"filename":"transactions.csv"}]}},"annotations":[]},"dependsOn":["[concat(variables('factoryId'), '/datasets/gitEMRds')]","[concat(variables('factoryId'), '/datasets/hosaDS')]"]},{"name":"[concat(parameters('factoryName'), '/gitEMRds')]","type":"Microsoft.DataFactory/factories/datasets","apiVersion":"2018-06-01","properties":{"linkedServiceName":{"referenceName":"[parameters('githubEMRFiles')]","type":"LinkedServiceReference"},"parameters":{"filename":{"type":"string"}},"annotations":[],"type":"DelimitedText","typeProperties":{"location":{"type":"HttpServerLocation","relativeUrl":{"value":"bigdatabysumitm/Trendytech-Azure-Project/refs/heads/main/datasets/EMR/trendytech-hospital-a/@{dataset().filename}","type":"Expression"}},"escapeChar":"\\","firstRowAsHeader":true},"schema":[]},"dependsOn":[]},{"name":"[concat(parameters('factoryName'), '/hosaDS')]","type":"Microsoft.DataFactory/factories/datasets","apiVersion":"2018-06-01","properties":{"linkedServiceName":{"referenceName":"[parameters('hosaSqlDB')]","type":"LinkedServiceReference"},"parameters":{"schema":{"type":"string","defaultValue":"dbo"},"tablename":{"type":"string"}},"annotations":[],"type":"AzureSqlTable","schema":[],"typeProperties":{"schema":{"value":"@dataset().schema","type":"Expression"},"table":{"value":"@dataset().tablename","type":"Expression"}}},"dependsOn":[]}]}